define(["jquery","ekyna-string"],function(a){"use strict";function b(b){b.data("FilePicker",this),this.$element=b,this.$file=b.find("input:file"),this.$text=b.find("input:text"),this.current=this.$text.data("current")||null,this.$file.on("change",a.proxy(this.onFileChange,this)),this.$text.on("click",a.proxy(this.onTextClick,this)),b.find('button[data-role="pick"]').on("click",a.proxy(this.onPickClick,this)),b.find('button[data-role="clear"]').on("click",a.proxy(this.onClearClick,this))}return b.prototype.onFileChange=function(){var b=this.$file.val();return 0<b.length?this.$text.val(b.fileName()):this.$text.val(this.current),this.$element.trigger(a.Event("ekyna.upload.change")),!1},b.prototype.onTextClick=function(a){return a.preventDefault(),this.$file.trigger("click"),!1},b.prototype.onPickClick=function(a){return a.preventDefault(),this.$file.trigger("click"),!1},b.prototype.onClearClick=function(b){return b.preventDefault(),this.clear(),this.$element.trigger(a.Event("ekyna.upload.clear")),!1},b.prototype.clear=function(){this.$file.files&&(this.$file.files=[]),this.$text.val(this.current),this.$file.val(null).trigger("change")},a.fn.filePickerWidget=function(){return this.each(function(){void 0===a(this).data("FilePicker")&&new b(a(this))}),this},{init:function(a){a.filePickerWidget()}}});